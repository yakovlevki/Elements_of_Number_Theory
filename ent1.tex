\documentclass[a4paper, 12pt]{article}

\usepackage{cmap}
\usepackage[T2A]{fontenc}
\usepackage[english, russian]{babel}
\usepackage[utf8]{inputenc}
\usepackage[left=2cm,right=1.5cm,top=2cm,bottom=2cm]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{etoolbox}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{graphicx}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\renewcommand{\phi}{\varphi}
\renewcommand{\epsilon}{\varepsilon}
\renewcommand{\emptyset}{\varnothing}
\newcommand{\lra}{\Leftrightarrow}
\renewcommand{\div}{\mid}
\newcommand{\ndiv}{\nmid}
\newcommand{\om}{\bar{\bar{o}}}
\newcommand\tab[1][.5cm]{\hspace*{#1}}

\newcounter{concount}

\theoremstyle{definition}
\newtheorem{definition}{Определение}[section]
\newtheorem{theorem}{Теорема}[section]
\newtheorem{consequense}[concount]{Следствие}
\newtheorem*{cons}{Следствие}
\newtheorem{lemma}{Лемма}[section]
\newtheorem{statement}{Утверждение}[section]
\newtheorem*{comm}{Замечание}
\newtheorem*{axiom}{Аксиома}
\newtheorem*{def20}{Определение 2.0}
\newtheorem*{algorithm}{Алгоритм}
\newtheorem*{introduction}{Введение}
\newtheorem*{eratosphene}{Решето Эратосфена}

\usepackage{titlesec}
\titleformat{\section}{\LARGE \bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\Large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\large\bfseries}{\thesubsubsection}{1em}{}

\usepackage{hyperref}
\usepackage{xcolor}
\definecolor{linkcolor}{HTML}{225ae2}
\definecolor{urlcolor}{HTML}{225ae2}
\hypersetup{
    pdfstartview=FitH, 
    linkcolor=linkcolor,
    urlcolor=urlcolor,
    colorlinks=true
}

\title{\textbf{Элементы теории чисел}}
\author{Лектор: Королев Максим Александрович}
\date{Конспект: Кирилл Яковлев, 108 группа, tg: @fourkenz}

\begin{document}
    \fontsize{14pt}{20pt}\selectfont
    \maketitle
    \newpage
    \tableofcontents
    \fontsize{14pt}{20pt}\selectfont
    \newpage
    \begin{introduction}
        Следующие понятия считаются интуитивно ясными:
    \end{introduction}
    \begin{enumerate}
        \item Понятие натурального ряда $\mathbb{N} = \{1, 2, 3, 4, 5, \dots\}$.
        \item У каждого натурального числа $n$ существует единственное натуральное число $m=n+1$ следующее за ним. 
        \item Понятие отрицательных чисел и нуля.
        \item Понятие суммы, разности и произведения двух целых чисел.
    \end{enumerate}
    \begin{axiom}
        Если $M \subset \mathbb{N}$ обладает следующими свойствами: $(1 \in M)$ и $(\forall n\in M$ выполнено $n+1 \in M)$, то $M = \mathbb{N}$.
    \end{axiom}
    \begin{consequense}
        Всякое непустое подмножество натурального ряда содержит минимальный элемент.
    \end{consequense}
    \begin{consequense}
        Всякое непустое конечное подмножество натурального ряда содержит максимальный элемент.
    \end{consequense}
    \begin{consequense} (Принцип математической индукции)\newline
        Если известно, что некоторое утверждение о натуральных числах выполнено для натурального числа $a$, а также из предположения о том, что утверждение верно при некотором $n$ следует справедливость этого утверждения и для числа $n+1$, то это утверждение верно для всех натуральных чисел, больше или равных $a$.
    \end{consequense}
    \section{Делимость целых чисел}
    \begin{definition}
        Пусть $a,b\in \mathbb{N}, b\ne 0$. Говорят что $a$ делится на $b$, если существует $c\in \mathbb{Z}$, такое, что $a=bc$.
    \end{definition}
    \begin{comm}
        $a$ называется делимым, а $b$ называется делителем числа $a$. Запись $b \mid a$ означает, что $b$ делит $a$. Если $b$ не делит $a$, то пишут $b\ndiv a$.
    \end{comm}
    \begin{lemma} \label{lemma1.1}
        Пусть $a,b,c \in \mathbb{Z}$, тогда:
        \begin{enumerate}
            \item $1 \mid a$.
            \item $a\ne 0 \Rightarrow a\mid a$.
            \item $a\mid b \Rightarrow a\mid bc$.
            \item $a\mid b$ и $b\mid c \Rightarrow a\mid c$.
            \item $a\mid b$ и $a\mid c \Rightarrow a\mid (b+c)$.
            \item $a\mid b$ и $b\ne 0 \Rightarrow |a|\leq|b|$.
        \end{enumerate}
    \end{lemma}
    \begin{theorem} \label{th1.1}
        Если $a\in \Z, b\in \N$, то  единственная пара целых чисел $q$ и $r$, такие, что $a=bq+r$, где $0\leq r\leq b-1$. 
    \end{theorem}
    \begin{proof}
        Докажем существование: Если $a$ делится на $b$, то $a=bc$. В таком случае возьмем $q=c, r=0$. Теперь пусть $a$ не делится на $b$. Рассмотрим непустое множество $M$ целых чисел, представимых в виде $a=kb, k\in \mathbb{Z}$, возьмем $k=-(|a|+1)$, тогда $a-kb=b(|a|+1)+a\geq b(|a|+1)-|a|\geq 1\cdot (|a|+1)-|a|=1 \Rightarrow a-kb$ - натуральное. Значит у $M$ есть минимальный элемент $a-kb$. Возьмем $q=k, r=a-kb=a-bq > 1$. Осталось показать, что $0\leq r\leq b-1$. Предположим, что $r\geq b$. Если $r=b$, то $a=bq+b=b(q+1)$ получаем противоречие, так как $a$ не делится на $b$. Значит $r=b+m, m\geq 1$. Получаем $1\leq m=r-b<r$, при этом $a=bq+r=bq+b+m=b(q+1)+m \Rightarrow m=a-b(q+1) \Rightarrow m\in M$ и $m<r$, получаем противоречие, так как $a$ не делится на $b$. Доказано, что $r<b \Rightarrow$ представление $a=bq+r$ - искомое. Докажем единственность: предположим, что для некоторого $a$ и $b$ имеются пары чисел с указаным свойством: $q,r$ и $q_1,r_1$, причем $0\leq r\leq r_1 \leq b-1$. Тогда $a=bq+r=bq_1+r_1\Rightarrow 0\leq b(q-q_1)=r_1-r$. Значит $b$ делит разность $r_1-r$. Допустим, что $q\ne q_1$, тогда по пункту 6 леммы \ref{lemma1.1} получаем $b\leq r_1-r$ и в то же время $r_1-r\leq b-1<b$. Получаем противоречие, значит $q=q_1$, а значит и $r=r_1$.
    \end{proof}
    \section{Наименьшее общее кратное и наибольший общий делитель (НОК и НОД)}
    \begin{def20}
         $n\geq 2, a_1, \dots, a_n \in \mathbb{N}$ пусть натуральное число $k$ делится на каждое из этих чисел. Тогда $k$ - общее кратное чисел $a_1, \dots, a_n$. \\
        Пусть $a_1, \dots, a_n$ - целые числа не все равные нулю. Натуральное число $d$ называется общим делителем $a_1, \dots, a_n$, если $d$ делит каждое из этих чисел.
    \end{def20}
    \begin{comm}
        Множество таких $k$ непусто, в нем лежит, например произведение всех этих чисел. \\ Множество таких $d$ конечно: если $a_i\ne 0$, то $d$ находится среди делителей числа $a_i$, (по пункту 6 леммы \ref{lemma1.1}) $d\leq |a_i|$, значит числа $d$ образуют конечное множество, оно непусто, так как содержит единицу.
    \end{comm}
    \begin{definition}
        Наименьшее натуральное число, делящееся на каждое из чисел $a_1, \dots, a_n$ называют их наименьшим общим кратным, его обозначают $[a_1, \dots, a_n]$.
    \end{definition}
    \begin{theorem} \label{th2.1}
        Каждое общее кратное натуральных чисел $a_1, \dots, a_n$ делится на их НОК.
    \end{theorem}
    \begin{proof}
        Пусть $M$ - общее кратное $a_1, \dots, a_n$, $K=[a_1, \dots, a_n]$. Поделим $M$ на $K$ с остатком: $M=kq+r, 0\leq r\leq k-1\leq k$. Допустим, что $K\ne 0$. По определению, всякое число $a_i$ делит оба числа $M$ и $K \Rightarrow a_i$ делит разность $k=M-qK$, значит $k$ является общим кратным для $a_1, \dots, a_n$, но $k<K$, получаем противоречие т.к какое-то кратное оказалось меньше минимального. Значит $k=0$ и $M=qK$.  
    \end{proof}
    \begin{definition}
        Наибольшее из натуральных чисел $d$ делящих каждое из чисел $a_1, \dots, a_n$, называют наибольшим общим делителем $a_1, \dots, a_n$, его обозначают $(a_1, \dots, a_n)$.
    \end{definition}
    \begin{definition}
        Числа $a$ и $b$ называется взаимно простыми, если $(a,b)=1$. Числа $a_1, \dots, a_n$ называются взаимно простыми в совокупности, если \\ $(a_1, \dots, a_n)=1$. Числа $a_1, \dots, a_n$ попарно взаимно просты, если $(a_i,a_j)=1$ $\forall i,j: 1\leq i<j\leq n$.
    \end{definition}
    \begin{theorem} \label{th2.2}
        $[a,b]\cdot (a,b)=ab, \forall a,b \in \mathbb{N}$.
    \end{theorem}
    \begin{proof}
        $ab$ - общее кратное $a$ и $b$. По теореме \ref{th2.1} $ab$ делится на $[a,b]$, то есть $ab=c[a,b]$, где $c\geq 1$ - натуральное число. Покажем, что $a$ и $b$ делятся на $c$. Действительно $a=\frac{ab}{[a,b]}\cdot \frac{[a,b]}{b}=c\cdot \frac{[a,b]}{b}$, $b=\frac{ab}{[a,b]}\cdot \frac{[a,b]}{a}=c\cdot \frac{[a,b]}{a}$, но оба числа $\frac{[a,b]}{a}$ и $\frac{[a,b]}{b}$ - натуральные, значит $c$ - общий делитель $a$ и $b$. Пусть теперь $d$ - произвольный общий делитель $a$ и $b$, тогда $\frac{ab}{d}=a\cdot \frac{b}{d}$, то есть число $\frac{ab}{d}$ делится нацело на каждое из чисел $a$ и $b$. По теореме \ref{th2.1}, оно делится на $[a,b]$, то есть $\frac{ab}{d}=[a,b]m, $ где $ m\geq 1$ - натуральное число, но тогда $\frac{ab}{[a,b]}=c=dm$, то есть $d$ делит $c$. В силу пункта 6 леммы \ref{lemma1.1} $d\leq c$, значит $c=(a,b)$.
    \end{proof}
    \begin{theorem} \label{th2.3}
        Пусть $a,b,c \in \mathbb{N}$, причем $a \div bc$ и $(a,b)=1$, тогда $a \div c$. 
    \end{theorem}
    \begin{proof}
        $(a,b)=1 \Rightarrow$ (по теореме \ref{th2.2}) $bc$ делится нацело на $[a,b]=ab$, то есть $bc=abm$, где $m\geq 1$ - натуральное число. Сократим обе части на $b$, получим $c=am$. 
    \end{proof}
    \begin{theorem} \label{th2.4}
        Пусть $\Delta=(a,b)\geq 1 \Rightarrow (\frac{a}{\Delta}, \frac{b}{\Delta})=1$.
    \end{theorem} 
    \begin{proof}
        Пусть $m\in \N$ и $m \mid \frac{a}{\Delta}, m \mid \frac{b}{\Delta}$ предположим, что $m > 1 \Rightarrow cm=\frac{a}{\Delta},dm=\frac{b}{\Delta}\Rightarrow \Delta cm=a, \Delta dm=b \Rightarrow \Delta m \mid a$ и $\Delta m\mid b\Rightarrow \Delta m$ - общий делитель $a$ и $b$. Но т.к $m>1$, то $\Delta m>\Delta \Rightarrow \Delta=(a,b) \leq \Delta m$ - противоречие, поскольку $\Delta$ - НОД $\Rightarrow m=1\Rightarrow (\frac{a}{\Delta}, \frac{b}{\Delta})=1$.
    \end{proof} 
    \section{Алгоритм Евклида}
    \begin{lemma} \label{lemma3.1}
        Пусть $a\in \Z, b\in \N$ и $b \mid a$. Тогда $(a,b)=b$.
    \end{lemma}
    \begin{proof}
        Пусть $(a,b)=c\Rightarrow c\mid b \Rightarrow$ (по лемме \ref{lemma1.1}) $c\leq b$, но $b\mid a,\\ b\mid b\Rightarrow b$ - общий делитель $a$ и $b\Rightarrow b\leq c\Rightarrow b=c=(a,b)$.
    \end{proof} 
    \begin{lemma} \label{lemma3.2}
        Пусть $a\in \Z, b\in \N, a=bq+r: r,q\in \Z, r\geq 0$. Тогда $(a,b)=(b,r)$. 
    \end{lemma} 
    \begin{proof}
        Пусть $\Delta=(a,b), \delta=(b,r)$. Имеем $\delta \div b \Rightarrow b\div bq, b\div r\Rightarrow$ (лемма \ref{lemma1.1}) $\delta \div bq+r=a\Rightarrow \delta \div a,\delta \div b\Rightarrow \delta$ - общий делитель $a$ и $b \Rightarrow \delta\leq \Delta$. \\ $\Delta \div b, \Delta \div bq, \Delta \div a\Rightarrow$ (лемма \ref{lemma1.1}) $\Delta \div a-bq=r\Rightarrow \Delta$ - общий делитель $b$ и $r\Rightarrow \Delta \leq \delta \Rightarrow \Delta = \delta$.
    \end{proof} 
    \begin{algorithm}
        Получаем, что при поиске НОД $a$ и $b, (a,b)$ можно заменять любой парой $(b,r)=(b,a-bq), q\in \Z$. Положим $r_0=a, r_1=b$. \\ 
        Выполняем деление с остатком:\\
        $$r_0=r_1q_1+r_2, 0<r_2<r_1\Rightarrow (r_0, r_1)=(r_1,r_2)$$
        $$r_1=r_2q_2+r_3, 0<r_3<r_2\Rightarrow (r_1, r_2)=(r_2,r_3)$$
        $$r_2=r_3q_3+r_4, 0<r_4<r_3\Rightarrow (r_2, r_3)=(r_3,r_4)$$
        \tab[8.5cm]\vdots 
        $$r_{n-2}=r_{n-1}q_{n-1}+r_n, 0<r_n<r_{n-1}\Rightarrow (r_{n-2}, r_{n-1})=(r_{n-1},r_n)$$
        $$r_{n-1}=r_nq_n$$
        $$\Rightarrow \text{(лемма \ref{lemma3.1})} (r_{n-1},r_n)=r_n\Rightarrow (a,b)=r_n$$
    \end{algorithm}
    \section{Решение в целых числах линейного уравнения с двумя неизвестными}
    Рассмотрим уравнение ($*$) $ax+by=c$, такое, что $a,b,c\in \Z, a$ и $b$ не равняются нулю одновременно. $x,y\in \Z$ - неизвестные.
    \begin{theorem} \label{th4.1}
        $(1)$ Уравнение $(*)$ разрешимо $\lra \Delta = (a,b) \div c$.\\
        $(2)$ В случае разрешимости, множество решений этого уравнения бесконечно, все решения имеют вид $x=x_0+\frac{b}{\Delta}t, y=y_0-\frac{a}{\Delta}t$, где $x_0,y_0$ - произвольное решение, а $t\in \Z$.
    \end{theorem} 
    \begin{proof}
        Докажем первый пункт:
        \begin{itemize}
            \item[$(\Rightarrow)$] Если $x,y$ - решение, то $\Delta \div ax, \Delta \div by\Rightarrow$ (лемма \ref{lemma1.1}) $\Delta \div ax+by\Rightarrow \Delta \div c$.
            \item[$(\Leftarrow)$] Не теряя общности, можем считать, что $a\geq b\geq 0$. Доказываем индукцией по сумме $a+b$. \\
            База: $a+b=1\Rightarrow b=0$ и $a=1 \Rightarrow$ уравнение имеет вид $ax=c\Rightarrow x=c$. Можем предъявить решение $x=c, y=0$. В этом случае $\Delta = (1,0) \div 1$. \\
            Шаг: $n\geq 1$, считаем, что утверждение доказано для всех уравнений с условием $a\geq b\geq 0$, $1\leq a+b\leq n$. Пусть $ax+by=c$, где $a\geq b\geq 0,\\ a+b=n+1$ и $\Delta = (a,b) \div c \Rightarrow$ докажем, что есть хотя бы одно решение. Пусть $b=0, ax=c, \Delta = (a,0)=a, a\div c\Rightarrow c=am\Rightarrow x=m, y=0$ - решение. Пусть $b\geq 1$. Рассмотрим уравнение $(a-b)X+bY=c,\\ a-b\geq 0, b\geq 1 >0$. $(a-b)+b=(a+b)-b=n+1-b\leq n$. $(a-b, b)=(a,b) \div c\\ \Rightarrow$ по предположению индукции есть целочисленное решение $X_0,X_0$. \\ $(a-b)X_0+bY_0=c\Rightarrow aX_0-b(Y_0-X_0)\Rightarrow x=X_0, y=Y_0-X_0$ - решение.\\
            Докажем второй пункт (проверим, что $x_0,y_0$ - решение):\\
            $a(x_0+\frac{b}{\Delta}t)+b(y_0-\frac{a}{\Delta}t)=ax_0+\frac{ab}{\Delta}t+ay_0-\frac{ab}{\Delta}t=ax_0+by_0$. Обратно: пусть $x_0,y_0$ и $x,y$ - различные решения. $ax_0+by_0=c, ax+by=c \\ \Rightarrow a(x-x_0)+b(y-y_0)=0\Rightarrow a(x-x_0)=b(y_0-y)$. $\Delta = (a,b) \\ \Rightarrow a=\alpha\Delta, b=\beta\Delta\Rightarrow$ (теорема \ref{th2.4}) $(\alpha,\beta)=1 \\ \Rightarrow \alpha\Delta(x-x_0)=\beta\Delta(y_0-y)\Rightarrow \alpha(x-x_0)=\beta(y_0-y) \\ \Rightarrow \alpha \div \beta(y_0-y)\Rightarrow \alpha \div (y_0-y)\Rightarrow y_0-y=\alpha t\Rightarrow \alpha (x-x_0)=\beta \alpha t\\ \Rightarrow x-x_0=\beta t$.
        \end{itemize}
    \end{proof}
    \section{Простые числа}
    \begin{definition}
        Натуральное число $n>1$ называется простым, если оно имеет ровно два делителя: $1$ и $n$. В противном случае это число называется составным.
    \end{definition}
    \begin{comm}
        Единица не причисляется ни к простым, ни к составным.
    \end{comm}
    \begin{lemma} \label{lemma5.1}
        Наименьший делитель натурального числа $n>1$, отличный от единицы - простое число.
    \end{lemma} 
    \begin{proof}
        Пусть $d\div n, 1\leq d \leq n$, и $d$ - наименьший с этими свойствами. Пусть $d$ - составное. Тогда $\exists k: k\div d$ и $1<k<d$. По лемме \ref{lemma1.1} $k\div n$, но $1<k<d$ - противоречие с тем, что $d$ - минимальный.
    \end{proof} 
    \begin{theorem} \label{th5.1}
        Множество простых чисел бесконечно.
    \end{theorem}
    \begin{proof}
        Пусть множество простых конечно: $p_1<p_2<\dots<p_n$ - все простые числа. Рассмотрим число $N = p_1p_2\dots p_n+1$. По лемме \ref{lemma5.1} наименьший делитель $p>1$ числа $N$ - простое число. Но $p$ отлично от $p_1\dots p_k, p$ делит $N$ нацело, а $N$ при делении на каждое из $p_1\dots p_n$ дает остаток $1$ - противоречие.
    \end{proof} 
    Пусть $x>0$, через $\pi(x)$ обозначим количество простых чисел на отрезке $[0, x]$ ($\pi(x)$ - количество простых чисел не превосходящих $x$).
    $$\pi(x)=\sum\limits_{p\leq x}1$$
    (Теорема \ref{th5.1}) $\lra \pi(x)$ - не ограничена сверху $\lra \pi(x)\to +\infty$ при $x\to +\infty$.\\
    Гипотеза Лежандра: $\pi(x)=\frac{x}{\ln x-C}$, где $C=1,08366$. Позднее Гаусс выдвенет более сложное и более точное предположение.
    Из доказательства теоремы Чебышева: $\forall \epsilon >0\exists x_0=x_0(\epsilon)$, т.ч. $\forall x\geq x_0$ выполнено неравенство:
    $$(A-\epsilon)\frac{x}{\ln x}<\pi(x)<(B+\epsilon)\frac{x}{\ln x}$$
    $$A=\ln (\frac{2^{\frac{1}{2}} \ 3^{\frac{1}{3}} \ 5^{\frac{1}{5}}}{30^{\frac{1}{30}}}), B=\frac{6}{5}A$$
    Асимптотический закон распределения простых чисел:
    $$\lim\limits_{x\to +\infty}(\frac{\pi(x)}{\frac{x}{\ln x}})=1 \lra A=B=1 \lra \pi(x)=(1+\om(1))\frac{x}{\ln x}$$
    \begin{lemma} \label{lemma5.2}
        Пусть $N$ - составное число, $p$ - наименьший простой делитель. Тогда $p\leq \sqrt{N}$.
    \end{lemma} 
    \begin{proof}
        $N$ - составное $\Rightarrow \exists a,b: 1<a<N, 1<b<N$ и $ab=N$. Значит $a\div N, b\div N, p$ - наименьший $\Rightarrow p\leq a, p\leq b \Rightarrow p^2\leq ab=N\\ \Rightarrow p\leq \sqrt{N}$.
     \end{proof}
    \begin{eratosphene}
        Выписываем все числа от $2$ до $N$, первое число в таблице - простое, это 2. Вычеркиваем все числа кратные 2, кроме нее самой. Первое невычеркнутое число после 2 - это 3 - значит оно простое. Вычеркиваем все числа, кратные 3, кроме самой 3. Первое невычеркнутое число после 3 - простое и т.д. После того как найдено наибольшее простое $p$ не превосходящее $\sqrt{N}$ и вычеркнуты все числа кратные $p$, в таблице останутся лишь простые числа, не превосходящие $N$ и только они.
    \end{eratosphene}
    \begin{theorem} \label{th5.2}
        (Основная теорема арифметики)\\
        Каждое целое число, большее $1$, раскладывается в произведение простых чисел, притом единственным способом (с точностью до порядка сомножителей). 
    \end{theorem}
    \begin{proof}
        Существование:\\ Индукция по $n>1$. Числа $n=2, n=3$ - простые, для них это утверждение справедливо. Пусть $n>3$ и допустим, справедливость утверждения проверки для всех $m<n$. Если $n$ - простое, то утверждение очевидно. Пусть $n$ - составное. По лемме \ref{lemma5.1} его наименьший делитель - простое число $\Rightarrow n=p_1k$, но $k=\frac{n}{p_1}\leq \frac{n}{2}<n$. По предположению индукции $k=p_2\dots p_r$, где $p_2,\dots,p_r$ - простые. $\Rightarrow n=p_1k=p_1p_2\dots p_r$ - искомое разложение.\\
        Единственность:\\
        Пусть $n=p_1\dots p_n=q_1\dots q_r,$ где $p_i,q_i$ - простые числа и $r\leq s$. Тогда\\ $p_1\dots p_r=q_1a_1$, где $a_1=q_2\dots q_s \Rightarrow p_1 \div q_1a_1$. Возможно два случая:\\
        1) $(p,q)>1 \Rightarrow p_1=q_1$.\\
        2) $(p,q)=1 \Rightarrow$ (теорема \ref{th2.3}) $p_1 \div a_1=q_2\dots q_s, a_1=q_2a_2, a_2=q_3\dots q_s,\\ p_1 \div q_2a_2\Rightarrow$ либо $p_1=q_2$, либо $p_1\div a_2$ и т.д. Но $a_1>a_2>\dots\geq 1 \Rightarrow$ на одном из шагов обязательно будет иметь место равенство $p_1=q_k, k\leq s$ (иначе оказалось бы, что $p_1 \div 1$, а это невозможно). Итак $p_1$ совпадает с одним из чисел $q_1,\dots,q_s$. Будем считать, что $p_1=q_1 \Rightarrow p_2\dots p_r=q_2\dots q_s$ продолжаем рассуждение и получаем, что $p_2$ совпадает с одним из $q_2,\dots q_s$, пусть $p_2=q_2$ и т.д. Если $r<s$ после $r$ шагов получили бы противоречивое равенство: $1=q_{r+1}\dots q_1 \\ \Rightarrow r=s$ и множества $\{p_1,\dots, p_r\}$ и $\{q_1, \dots , q_s\}$ совпадают.
    \end{proof}
    \begin{comm}
        $n>1, n=q_1\dots q_s \Rightarrow n$ можно записать в виде $n=p_1^{\alpha_1}\dots p_k^{\alpha_k}, \\ p_1<p_2<\dots<p_k$ - каноническое разложение $n$ на простые сомножители.
    \end{comm} 
    \begin{definition}
        Пусть $n=p_1^{\alpha_1}\dots p_k^{\alpha_k}, p$ - простое. Тогда
        $$\nu_p(n)=
        \begin{cases}
            0, \hspace{5pt} $если $p\ndiv n,\\
            \alpha, \hspace{5pt} $если$ p=p_i. 
        \end{cases}$$
    \end{definition}    
    \begin{lemma} (Свойства $\nu_p(n)$) \label{lemma5.3}
        \begin{enumerate}
            \item Для любых целых чисел $a,b>1$ и любого простого $p$ справедливо равенство: $\nu_p(ab)=\nu_p(a)+\nu_p(b)$.
            \item Пусть $m,n>1$ - целые числа, тогда $m \div n \lra \nu_p(m)\leq \nu_p(n)$ для любого простого $p$.
        \end{enumerate}
    \end{lemma}
    \begin{proof} \tab
        \begin{enumerate}
            \item При перемножении степеней с одинаковыми основаниями, их показатели складываются.
            \item    
            \begin{itemize}
                \item[$(\Rightarrow)$] Пусть $n=km \Rightarrow \nu_p(n)=\nu_p(k)+\nu_p(m)\geq \nu_p(m)$.
                \item[$(\Leftarrow)$] Все разности $\nu_p(n)-\nu_p(m)$ - целые неотрицательные. Рассмотрим число:
                $$k = \prod\limits_pp^{\nu_p(n)-\nu_p(m)}$$ 
                Если $k=1$, то $\nu_p(n)=\nu_p(m)$ для всех $p$ и $m=n$. В силу основной теоремы арифметики, в этом случае $m \div n$. Пусть $k>1$, тогда в силу пункта 1:
                $$km=\prod\limits_pp^{\nu_p(n)-\nu_p(m)}\cdot \prod\limits_pp^{\nu_p(m)}=\prod\limits_pp^{\nu_p(n)}=n$$
                то есть $m \div n$. 
            \end{itemize}
        \end{enumerate}
    \end{proof}
    \begin{theorem} (В сбитой номерации М.А. Королева это теорема 5.4)\label{th5.3}\\
        Для любых $a,b\in \N$ справедливы равенства:
        $$[a,b]=\prod\limits_pp^{\max(\nu_p(a),\nu_p(b))}$$
        $$(a,b)=\prod\limits_pp^{\min(\nu_p(a),\nu_p(b))}$$
    \end{theorem}
    \begin{proof}
        Обозначим $K=[a,b],$ $N=\prod\limits_pp^{\max(\nu_p(a),\nu_p(b))}$ поскольку\\ $\nu_p(a)\leq \nu_p(N),$ $\nu_p(b)\leq \nu_p(N)$, то $a$ и $b$ делят $N$ в силу леммы \ref{lemma5.3}. Значит $N$ - общее кратное чисел $a$ и $b$. С другой стороны, поскольку $a$ и $b$ делят $K$, то по лемме \ref{lemma5.3} имеем $\nu_p(a),\nu_p(b)\leq \nu_p(K)$, так что $\nu_p(K)\geq \max(\nu_p(a), \nu_p(b))=\nu_p(N)$ для любого простого $p$. Значит, $N\div K$, но $N\leq K \Rightarrow N=K$. Вторая часть утверждения следует из первой, если воспользоваться равенством
        $$(a,b)=\frac{ab}{[a,b]}$$
        и тем, что $x+y=\max(x,y)+\min(x,y)$ $\forall x,y\in \R$.
    \end{proof}
    \section{Мультипликативные функции}
    \begin{definition}
        Функция $f$, определенная на множестве $\N$ называется мультипликативной, если для любых взаимно простых $a,b\in \N$ выполнено равенство:
        $$f(ab)=f(a)f(b)$$
    \end{definition}
    \begin{theorem}(Простейшие свойтсва мультипликативных функций) \label{th6.1}\\
        Пусть $f,g$ - мультипликативные функции. Тогда:
        \begin{enumerate}
            \item Если $f\not\equiv 0$, то $f(1)=1$.
            \item Если $n=p_1^{\alpha_1}\dots p_r^{\alpha_r}$ - каноническое разложение $n$, то $f(n)=f(p_1^{\alpha_1})\dots f(p_r^{\alpha_r})$.
            \item Функция $h$, определенная для любого $n\in \N$ равенством\\ $h(n)=f(n)g(n)$ - мультипликативна. 
        \end{enumerate}
        \begin{proof}
            Так как $f\not\equiv 0$, то $\exists a\in \N: f(a)\ne 0$. Тогда\\ $f(a)=f(a\cdot 1)=f(a)f(1) \Rightarrow f(1)=1$.
        \end{proof}
    \end{theorem}
    Для исседование дальнейших свойств мультипликативных функций потребуется несколько вспомогательных лемм
    \begin{lemma} \label{lemma6.1}
        Пусть $r\geq 2$ и пусть целые числа $a_1,\dots, a_r$ попарно взаимно просты. Тогда найдется номер $1\leq \xi\leq r$ такой, что $p\div a_\xi$.
    \end{lemma} 
    \begin{proof}
        Индукция по $\xi$. Если $r=2$, то это есть очевидно следствие теоремы \ref{th2.3}. Пусть $m\geq 3$ и утверждение доказано для всех $r\leq m-1$. Пусть $a_1,\dots a_m$ попарно взаимно просты и $p \div a_1\cdot...\cdot a_m$. Полагая $a=a_1\cdot ... \cdot a_{m-1}$ будем иметь: $p \div aa_m$. Если $(p,a)=1$, то $p\div a_m$ по теореме \ref{th2.3}. Пусть $(p,a)>1$. Так как $p$ - простое, то $(p,a)=p$ и $p$ делит некоторый сомножитель $a_{\xi}: 1\geq\xi\geq m-1$.
    \end{proof} 
    \begin{lemma} \label{lemma6.2}
        Пусть $b\div a,$ $c\div a$, причем $(b,c)=1$. Тогда $bc\div a$.
    \end{lemma}
    \begin{proof}
        Из условия следует, что $a$ - общее кратное $b$ и $c$. По теореме \ref{th2.1} $a$ делится на $[b,c]$, по теореме \ref{th2.2} $[b,c]=bc$.
    \end{proof}
    \begin{cons}
        Пусть $r\geq 2$, и пусть целые числа $b_1\dots b_r$ попарно взаимно просты, причем $b_1 \div a, \dots, b_r \div a$. Тогда $b_1\dots b_r \div a$.
    \end{cons} 
    \begin{proof}
        Индукция по $r$. Если $r=2$, получаем утверждение леммы. Пусть $m\geq 3$ и утверждение доказано для всех $r\leq m-1$. Пусть $b_1, \dots b_m$ попарно взаимно просты и каждое из них делит $a$. В силу предложения индукции, $a$ делится на произведение $b_1\dots b_{m-1}$. Заметим, что $(b,b_m)=1$. Действительно, в противном случае найдется простое число $p$, делящееся как на $b_m$ так и на $b$. По лемме \ref{lemma6.1} $p$ будет делить и некоторые $b_{\xi}: 1\geq \xi \geq m-1$. Следовательно $(b_m,b_{\xi})\geq p>1$, что противоречит условию. Так как $a$ делится на $b$ и $b_m$, и $(b, b_m)=1$, то в силу леммы \ref{lemma6.2} $a$ делится на $bb_m=b_1\dots b_m$.
    \end{proof}
    \begin{lemma} \label{lemma6.3}
        Пусть числа $a$ и $b$ взаимно просты, и пусть $d_1$ и $d_2$ пробегают соответственно множества всех делителей $a$ и $b$. Тогда величина $d=d_1d_2$ пробегает без повторений все множество делителей числа $ab$.
    \end{lemma} 
    \begin{proof} \tab
        \begin{enumerate}
            \item Если $d_1 \div a,$ $d_2 \div b$, то $a=kd_1,$ $b=md_2$ при некоторых $k,m\in \Z$, так что $ab=kmd_1d_2$, то есть $d_1d_2$ - делитель $ab$.
            \item Допустим, что $d_1d_2=\delta_1\delta_2$ для некоторых чисел $d_1, \delta_1$ делящих $a$ и некоторых чисел $d_2, \delta_2$, делящих $b$. Очевидно, что $(d_1,\delta_2)=1$, так как в противном случае нашлось бы простое $p$, делящееся одновременно и $a$ и $b$, что невозможно. Но $d_1 \div \delta_1\delta_2$ по теореме \ref{th2.3} $d_1 \div \delta_1$ и, следовательно $d_1\leq \delta_1$. Аналогично доказывается, что $\delta_1\div d_1$ и $\delta_1\leq d_1$. Значит $d_1=\delta_1, d_2=\delta_2$, то есть все произведения $d_1$ и $d_2$ различны.
            \item Докажем, наконец, что всякий делитель $d$ числа $ab$ встретится среди произведений $d_1d_2$. Если $d=1$, то это очевидно. Пусть $d\geq 2$ и $p_1^{\alpha_1}\dots p_r^{\alpha_r}$ - каноническое разложение $d$. Число $q_1=p_1^{\alpha_1} \div ab$. Из теоремы \ref{th2.3} следует, что $q_1$ делит либо $a$, либо $b$ (но не оба сразу). То же верно и дял чисел $q_{\xi}=p_{\xi}^{\alpha_{\xi}}, \xi=2,3,\dots,r$. Пусть, для определенности, $q_1,\dots, q_t$ - все сомножители, делящие $a$, и $q_{t+1},\dots, q_r$ - все сомножители, делящие $b$. По следствию леммы \ref{lemma6.2} произведение $d_1=q_1\dots q_t$ делит $a$, произведение $d_2=q_{t+1},\dots, q_r$ делит $b$, но $d_1d_2=d$.
        \end{enumerate}
    \end{proof}
    \begin{theorem}
        Пусть функция $f$ мультипликативна. Тогда функция $F$, определенная при любом $n\in \N$ равенством:
        $$F(n)=\sum\limits_{d\div n}f(d)$$
        мультипликативна.
    \end{theorem}
    \begin{proof}
        Пусть $(a,b)=1$. По лемме \ref{lemma6.3}, все делители $ab$ получим без повторений, рассмотрев все произведения $d=d_1d_2$, где $d_1 \div a$, $d_2 \div b$. Значит
        $$F(ab)=\sum\limits_{d\div ab}f(d)=\sum\limits_{d_1 \div a}\sum\limits_{d_2 \div b}f(d_1d_2)=\sum\limits_{d_1 \div a}\sum\limits_{d_2 \div b}f(d_1)f(d_2)=$$
        $$=(\sum\limits_{d_1 \div a}f(d_1))(\sum\limits_{d_2 \div b}f(d_2))=F(a)F(b).$$
        Взаимная простота $d_1$ и $d_2$ очевидна.
    \end{proof} 
    \begin{cons}
        Если $p_1^{\alpha_1}\dots p_r^{\alpha_r}$ - каноническое разложение $n$, а $F$ - функция из условия теоремы, то
        $$F(n)=\prod\limits_{i=1}^{r}(1+f(p_i)+f(p_i^2)+\dots +f(p_i^{\alpha_i}))$$
        (при условии что $f\not\equiv 0$).
    \end{cons} 
\end{document}